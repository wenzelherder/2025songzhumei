<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>政大泳隊 | 松竹梅邀請賽行前通知</title>
    <!-- 引入 Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'ncp-blue': '#004d99', // 政大藍
                        'ncp-light': '#e6f0ff',
                        'ncp-dark': '#00264d',
                        'highlight-bg': '#fde047', // Yellow-300 for strong highlight
                        'highlight-border': '#b91c1c', // Red-700 for strong border
                    },
                    fontFamily: {
                        sans: ['Inter', 'Microsoft JhengHei', 'PingFang TC', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <style>
        /* 自定義滾動條樣式，使其在行動裝置上更簡潔 */
        ::-webkit-scrollbar {
            width: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        ::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #999;
        }
        .table-cell-content {
            /* 允許內容換行，提升在堆疊卡片中的可讀性 */
            white-space: normal; 
            word-break: break-word;
        }
        /* 新增置中樣式 */
        .text-center-column {
            text-align: center;
        }
        /* 高亮樣式 (更明顯的反白效果) */
        .highlighted-row {
            background-color: var(--highlight-color, '#fde047') !important; /* Bright Yellow-300 */
            border-left: 6px solid #b91c1c !important; /* Thick Red-700 Border */
            font-weight: bold;
            box-shadow: 0 0 0 1px #b91c1c; 
        }
        .schedule-row {
            background-color: #ffffff !important; 
        }
        .schedule-row.bg-gray-50 {
            background-color: #f9fafb !important;
        }
        
        /* 針對小螢幕，調整任務分配表格的寬度，確保內容不會過於擠壓 */
        @media (max-width: 640px) {
            #task-table th, #task-table td {
                padding-left: 8px;
                padding-right: 8px;
            }
            #task-table th:nth-child(2), #task-table td:nth-child(2) {
                min-width: 200px; 
            }
        }

        /* **** 核心響應式表格 (卡片式) 樣式 **** */
        @media (max-width: 639px) { /* < sm breakpoint */
            #schedule-table-am, #schedule-table-pm {
                display: block;
                width: 100%;
            }
            #schedule-table-am thead, #schedule-table-pm thead {
                display: none; /* 隱藏原表頭 */
            }
            #schedule-table-am tbody, #schedule-table-pm tbody, 
            #schedule-table-am tr, #schedule-table-pm tr, 
            #schedule-table-am td, #schedule-table-pm td {
                display: block;
                width: 100%;
            }
            
            #schedule-table-am tr, #schedule-table-pm tr {
                margin-bottom: 12px;
                border: 1px solid #ddd;
                border-radius: 8px;
                box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
                transition: all 0.2s;
            }
            
            #schedule-table-am td {
                padding: 8px 10px 8px 120px; /* 標籤留出空間 */
                position: relative;
                text-align: left !important;
                border: none;
                border-bottom: 1px solid #eee; 
            }
            #schedule-table-pm td {
                /* 下午場也適用 */
                padding: 8px 10px 8px 120px; 
                position: relative;
                text-align: left !important;
                border: none;
                border-bottom: 1px solid #eee; 
            }
            
            #schedule-table-am td:last-child, #schedule-table-pm td:last-child {
                border-bottom: none;
            }

            #schedule-table-am td::before, #schedule-table-pm td::before {
                content: attr(data-label);
                position: absolute;
                left: 0;
                top: 0;
                bottom: 0;
                width: 110px; /* 標籤寬度 */
                padding: 8px 10px;
                font-weight: bold;
                background-color: #f3f4f6; /* Tailwind gray-100 */
                color: #004d99; /* ncp-blue */
                display: flex;
                align-items: center;
                border-right: 1px solid #ddd;
            }

             /* 修正高亮卡片模式的樣式 */
             .highlighted-row {
                background-color: #fde047 !important;
                border: 2px solid #b91c1c !important;
                box-shadow: 0 4px 8px rgba(185, 28, 28, 0.2) !important;
            }
            .highlighted-row td::before {
                background-color: #fbbf24 !important; /* 標籤顏色變深 (yellow-400) */
            }
        }
        /* **** 結束核心響應式表格樣式 **** */
    </style>
</head>
<body class="bg-gray-50 p-4 sm:p-8 font-sans">

    <div class="container mx-auto max-w-4xl bg-white shadow-xl rounded-2xl p-6 sm:p-10 border-t-8 border-ncp-blue">

        <!-- 標題 -->
        <header class="text-center mb-8">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-ncp-dark tracking-tight leading-snug">
                📢 第26屆松竹梅全國游泳邀請賽
            </h1>
            <p class="text-xl text-ncp-blue mt-2 font-semibold">政大泳隊行前通知</p>
        </header>

        <!-- 集合資訊 -->
        <section class="mb-8 p-4 bg-ncp-light rounded-xl border border-ncp-blue/30">
            <h2 class="text-2xl font-bold text-ncp-blue mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                🗓️ 集合資訊
            </h2>
            <div class="space-y-3 text-lg">
                <p><span class="font-medium text-gray-700">日期:</span> <strong class="text-ncp-dark">11/29（六）</strong></p>
                <p><span class="font-medium text-gray-700">時間:</span> <strong class="text-red-600 text-xl font-extrabold">早上 05:00</strong> (<span class="text-red-600 font-semibold">請務必準時，遊覽車不等人</span>)</p>
                <p><span class="font-medium text-gray-700">地點:</span> <strong class="text-ncp-dark">好漢坡</strong></p>
                <p><span class="font-medium text-gray-700">比賽地點:</span> 中華大學游泳池</p>
                <p><span class="font-medium text-gray-700">遊覽車公司資訊:</span> 飛騰通運 / 聯絡人王女士 0925-168-869</p>
            </div>
        </section>

        <!-- 必帶物品與服裝規定 -->
        <section class="mb-8">
            <h2 class="text-2xl font-bold text-ncp-blue mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                🎒 必帶物品與服裝規定
            </h2>
            <div class="overflow-x-auto shadow-md rounded-xl">
                <table class="min-w-full bg-white">
                    <thead>
                        <tr class="bg-gray-200">
                            <th class="py-3 px-4 border-b text-ncp-dark">類別</th>
                            <th class="py-3 px-4 border-b text-ncp-dark">項目清單</th>
                            <th class="py-3 px-4 border-b text-ncp-dark">備註</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-3 px-4 font-semibold text-gray-800 table-cell-content">證件類</td>
                            <td class="py-3 px-4 table-cell-content">🪪 <strong>身分證</strong>、🪪 <strong>健保卡</strong>、🪪 <strong>學生證</strong></td>
                            <td class="py-3 px-4 text-red-500 font-medium table-cell-content">檢錄查驗必備，缺一不可</td>
                        </tr>
                        <tr class="bg-gray-50">
                            <td class="py-3 px-4 font-semibold text-gray-800 table-cell-content">裝備類</td>
                            <td class="py-3 px-4 table-cell-content">🏊 泳具、🧣 毛巾、💊 個人藥品、🩴 拖鞋</td>
                            <td class="py-3 px-4 table-cell-content">建議多帶一套備用泳具</td>
                        </tr>
                        <tr>
                            <td class="py-3 px-4 font-semibold text-gray-800 table-cell-content">服裝規定</td>
                            <td class="py-3 px-4 table-cell-content">👕 <strong>隊服</strong>、👖 <strong>隊服短褲</strong> 或 <strong>黑色長褲</strong></td>
                            <td class="py-3 px-4 text-ncp-blue font-medium table-cell-content">請務必穿著隊服，長褲請穿黑色</td>
                        </tr>
                        <tr class="bg-gray-50">
                            <td class="py-3 px-4 font-semibold text-gray-800 table-cell-content">公用器材</td>
                            <td class="py-3 px-4 table-cell-content">🚩 隊旗、🧘 瑜珈墊、🟦 地墊</td>
                            <td class="py-3 px-4 text-gray-600 table-cell-content"><strong>11/28(五) 19:00</strong> 搬運到商學院或宿舍<br><strong>11/29(六)</strong> 由大一學弟搬運上車</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 安全與緊急聯絡 -->
        <section class="mb-8 p-4 bg-red-50 rounded-xl border border-red-300">
            <h2 class="text-2xl font-bold text-red-700 mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.398 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                🚨 安全回報與緊急聯絡 (<span class="font-extrabold">重要！</span>)
            </h2>
            <p class="mb-3">請所有隊員務必完成以下兩件事：</p>
            <ul class="list-disc list-inside space-y-2 mb-4 ml-4">
                <li class="font-bold text-ncp-dark">
                    <strong>通報家人與備援聯繫:</strong> 請務必將正、副隊長的聯絡資訊提供給家人，以便在緊急狀況或無法聯繫到隊員本人時，可以聯絡正、副隊長。
                </li>
                <li class="font-bold text-red-700"><strong>健康告知 (務必口頭說明)</strong>：若過去有曾因任何事情送過急診、氣喘、癲癇、嚴重腸胃炎、曾有開刀或住院經驗，請務必事先口頭告知正、副隊長。</li>
            </ul>
            <div class="overflow-x-auto">
                <table class="min-w-full">
                    <thead>
                        <tr class="bg-red-200">
                            <th class="py-2 px-4 border-b">職稱</th>
                            <th class="py-2 px-4 border-b">聯絡人</th>
                            <th class="py-2 px-4 border-b">電話</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-2 px-4 font-semibold">隊長</td>
                            <td class="py-2 px-4 font-semibold text-red-600">慶瑜</td>
                            <td class="py-2 px-4 text-red-600">0912-832-338</td>
                        </tr>
                        <tr>
                            <td class="py-2 px-4 font-semibold">副隊長</td>
                            <td class="py-2 px-4 font-semibold text-red-600">小宜臻</td>
                            <td class="py-2 px-4 text-red-600">0936-792-856</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 暖身菜單 -->
        <section class="mb-8">
            <h2 class="text-2xl font-bold text-ncp-blue mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 0a8 8 0 01-8 8m8-8v8m-4-2H8"></path></svg>
                🏊 賽前試水暖身菜單 (Warm-up)
            </h2>
            <div class="overflow-x-auto shadow-md rounded-xl">
                <table class="min-w-full bg-white">
                    <thead>
                        <tr class="bg-green-100">
                            <th class="py-3 px-4 border-b text-ncp-dark">項目</th>
                            <th class="py-3 px-4 border-b text-ncp-dark">內容</th>
                            <th class="py-3 px-4 border-b text-ncp-dark">重點提示</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-3 px-4 font-semibold">熱身 (Warm Up)</td>
                            <td class="py-3 px-4">200m 慢游 (Choice)</td>
                            <td class="py-3 px-4">感受水感，放鬆肌肉</td>
                        </tr>
                        <tr class="bg-gray-50">
                            <td class="py-3 px-4 font-semibold">分解 (Drill)</td>
                            <td class="py-3 px-4">4 x 50m 分解動作</td>
                            <td class="py-3 px-4">調整姿勢，專注核心穩定</td>
                        </tr>
                        <tr>
                            <td class="py-3 px-4 font-semibold">衝刺 (Pace)</td>
                            <td class="py-3 px-4">4 x 25m 比賽配速</td>
                            <td class="py-3 px-4">測試出發與轉身，喚醒爆發力</td>
                        </tr>
                        <tr class="bg-gray-50">
                            <td class="py-3 px-4 font-semibold">緩和 (Cool Down)</td>
                            <td class="py-3 px-4">100m 放鬆游</td>
                            <td class="py-3 px-4">調整呼吸</td>
                        </tr>
                        <tr class="bg-green-200">
                            <td class="py-3 px-4 font-bold">總距離</td>
                            <td class="py-3 px-4 font-bold">約 500m - 600m</td>
                            <td class="py-3 px-4 font-medium">依個人狀況自行增減</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 大一分工 -->
        <section class="mb-8">
            <h2 class="text-2xl font-bold text-ncp-blue mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M5 12h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v2a2 2 0 002 2z"></path></svg>
                👥 大一新生任務分配
            </h2>
            <div class="overflow-x-auto shadow-md rounded-xl">
                <!-- ID for task table to adjust mobile width if necessary -->
                <table id="task-table" class="min-w-full bg-white">
                    <thead>
                        <tr class="bg-yellow-200">
                            <!-- 任務職責寬度調整為 50% -->
                            <th class="py-3 px-4 border-b" style="width: 20%;">組別</th>
                            <th class="py-3 px-4 border-b" style="width: 50%;">任務職責</th>
                            <th class="py-3 px-4 border-b" style="width: 30%;">關鍵指標 (KPI)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="py-3 px-4 font-semibold">📋 檢錄組</td>
                            <td class="py-3 px-4">掌握賽程，安排人員提醒與帶領選手至檢錄處。</td>
                            <td class="py-3 px-4 font-bold text-green-600">全員準時檢錄，嚴禁漏檢錄。</td>
                        </tr>
                        <tr class="bg-gray-50">
                            <td class="py-3 px-4 font-semibold">📦 器材組</td>
                            <td class="py-3 px-4">負責隊旗、🧘 瑜珈墊、🟦 地墊的上下車搬運與清點，組織搬便當，妥善組織丟垃圾、回收事宜，維持休息區清潔整潔。</td>
                            <td class="py-3 px-4 font-bold text-green-600">器材無遺漏，休息區佈置完善。</td>
                        </tr>
                        <tr>
                            <td class="py-3 px-4 font-semibold">📷 攝影組</td>
                            <td class="py-3 px-4">紀錄比賽精彩瞬間（平面拍照、動態錄影）。</td>
                            <td class="py-3 px-4 font-bold text-green-600">每位出賽隊員 (共31人) 必須有「獨照、合照」合計至少 5 張。</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>


        <!-- 賽程表 -->
        <section id="schedule-section">
            <h2 class="text-2xl font-bold text-ncp-blue mb-4 flex items-center">
                <svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                🏆 政大泳隊賽程表
            </h2>
            <!-- 賽程追蹤選擇器 -->
            <div class="mb-4 flex flex-col sm:flex-row sm:items-center space-y-2 sm:space-y-0 sm:space-x-3">
                <label for="member-selector" class="font-bold text-gray-700">選擇隊員追蹤賽程:</label>
                <select id="member-selector" onchange="highlightMember(this.value)" class="p-2 border rounded-lg shadow-sm focus:ring-ncp-blue focus:border-ncp-blue w-full sm:w-auto">
                    <option value="">-- 選擇一位隊員 --</option>
                </select>
            </div>
            
            <!-- 專屬賽程卡片 (新增區塊) -->
            <div id="summary-card" class="mt-4 p-4 rounded-xl shadow-2xl border-2 border-ncp-blue bg-white transition-all duration-300 hidden">
                <!-- Content will be injected by JavaScript -->
            </div>

            <!-- 修正提示文字 -->
            <p class="mb-4 text-sm text-gray-600 bg-yellow-100 p-2 rounded-lg">⚠️ 時間僅供參考，請依現場廣播為準。接力項目請隨時準備。</p>

            <!-- 上午場 -->
            <h3 class="text-xl font-semibold text-ncp-dark mt-6 mb-3 border-b pb-1">☀️ 上午場 (08:00 開始)</h3>
            <div class="shadow-md rounded-xl">
                <table id="schedule-table-am" class="min-w-full bg-white">
                    <thead>
                        <tr class="bg-ncp-light">
                            <!-- 編號, 預計時間, 項目 置中 -->
                            <th class="py-3 px-4 border-b text-center-column">編號</th>
                            <th class="py-3 px-4 border-b text-center-column">預計時間</th>
                            <th class="py-3 px-4 border-b text-center-column">項目</th>
                            <th class="py-3 px-4 border-b">參賽隊員</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 嚴格依據最新圖片數據更新上午場賽程 -->
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">1</td><td data-label="預計時間" class="table-cell-content text-center-column">08:30 - 08:40</td><td data-label="項目" class="table-cell-content text-center-column">女子 200公尺自由式</td><td data-label="參賽隊員" class="table-cell-content">柏巧</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">2</td><td data-label="預計時間" class="table-cell-content text-center-column">08:40 - 08:55</td><td data-label="項目" class="table-cell-content text-center-column">男子 200公尺自由式</td><td data-label="參賽隊員" class="table-cell-content">康驊、仲曛、梓宏、慶瑜*</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">3</td><td data-label="預計時間" class="table-cell-content text-center-column">08:55 - 09:10</td><td data-label="項目" class="table-cell-content text-center-column">女子 200公尺蝶式</td><td data-label="參賽隊員" class="table-cell-content">(無人參賽)</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">4</td><td data-label="預計時間" class="table-cell-content text-center-column">09:10 - 09:25</td><td data-label="項目" class="table-cell-content text-center-column">男子 200公尺蝶式</td><td data-label="參賽隊員" class="table-cell-content">秉陞</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">5</td><td data-label="預計時間" class="table-cell-content text-center-column">09:25 - 09:40</td><td data-label="項目" class="table-cell-content text-center-column">女子 100公尺蛙式</td><td data-label="參賽隊員" class="table-cell-content">Emma、小宜臻</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">6</td><td data-label="預計時間" class="table-cell-content text-center-column">09:40 - 09:55</td><td data-label="項目" class="table-cell-content text-center-column">男子 100公尺蛙式</td><td data-label="參賽隊員" class="table-cell-content">品謙、則睿、柏淵</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">7</td><td data-label="預計時間" class="table-cell-content text-center-column">09:55 - 10:10</td><td data-label="項目" class="table-cell-content text-center-column">女子 100公尺仰式</td><td data-label="參賽隊員" class="table-cell-content">嘉穎、宥妏</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">8</td><td data-label="預計時間" class="table-cell-content text-center-column">10:10 - 10:25</td><td data-label="項目" class="table-cell-content text-center-column">男子 100公尺仰式</td><td data-label="參賽隊員" class="table-cell-content">澤享、至瀚、浩元、岱融</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">9</td><td data-label="預計時間" class="table-cell-content text-center-column">10:25 - 10:40</td><td data-label="項目" class="table-cell-content text-center-column">女子 400公尺自由式接力</td><td data-label="參賽隊員" class="table-cell-content">TBD</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">10</td><td data-label="預計時間" class="table-cell-content text-center-column">10:40 - 10:55</td><td data-label="項目" class="table-cell-content text-center-column">男子 400公尺自由式接力</td><td data-label="參賽隊員" class="table-cell-content">全體隊員</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">11</td><td data-label="預計時間" class="table-cell-content text-center-column">10:55 - 11:05</td><td data-label="項目" class="table-cell-content text-center-column">女子 50公尺蝶式</td><td data-label="參賽隊員" class="table-cell-content">嘉穎、又綺、禹榛、乃予</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">12</td><td data-label="預計時間" class="table-cell-content text-center-column">11:05 - 11:20</td><td data-label="項目" class="table-cell-content text-center-column">男子 50公尺蝶式</td><td data-label="參賽隊員" class="table-cell-content">澤享、則文、至瀚、大益、晟剛、宸瑋*</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">13</td><td data-label="預計時間" class="table-cell-content text-center-column">11:20 - 11:35</td><td data-label="項目" class="table-cell-content text-center-column">女子 200公尺混合式</td><td data-label="參賽隊員" class="table-cell-content">Emma、毛毛</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">14</td><td data-label="預計時間" class="table-cell-content text-center-column">11:35 - 11:50</td><td data-label="項目" class="table-cell-content text-center-column">男子 200公尺混合式</td><td data-label="參賽隊員" class="table-cell-content">(無人參賽)</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">15</td><td data-label="預計時間" class="table-cell-content text-center-column">11:50 - 12:05</td><td data-label="項目" class="table-cell-content text-center-column">女子 100公尺自由式</td><td data-label="參賽隊員" class="table-cell-content">柏巧、亮柔*</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">16</td><td data-label="預計時間" class="table-cell-content text-center-column">12:05 - 12:20</td><td data-label="項目" class="table-cell-content text-center-column">男子 100公尺自由式</td><td data-label="參賽隊員" class="table-cell-content">為政、秉陞</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">17</td><td data-label="預計時間" class="table-cell-content text-center-column">12:20 - 12:35</td><td data-label="項目" class="table-cell-content text-center-column">女子 400公尺混合式接力</td><td data-label="參賽隊員" class="table-cell-content">全體隊員</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">18</td><td data-label="預計時間" class="table-cell-content text-center-column">12:35 - 12:50</td><td data-label="項目" class="table-cell-content text-center-column">男子 400公尺混合式接力</td><td data-label="參賽隊員" class="table-cell-content">全體隊員</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- 下午場 -->
            <h3 class="text-xl font-semibold text-ncp-dark mt-6 mb-3 border-b pb-1">🌙 下午場 (13:30 開始)</h3>
            <div class="shadow-md rounded-xl">
                <table id="schedule-table-pm" class="min-w-full bg-white">
                    <thead>
                        <tr class="bg-ncp-light">
                             <!-- 編號, 預計時間, 項目 置中 -->
                            <th class="py-3 px-4 border-b text-center-column">編號</th>
                            <th class="py-3 px-4 border-b text-center-column">預計時間</th>
                            <th class="py-3 px-4 border-b text-center-column">項目</th>
                            <th class="py-3 px-4 border-b">參賽隊員</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- 嚴格依據最新圖片數據更新下午場賽程 -->
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">19</td><td data-label="預計時間" class="table-cell-content text-center-column">13:30 - 13:40</td><td data-label="項目" class="table-cell-content text-center-column">女子 400公尺自由式</td><td data-label="參賽隊員" class="table-cell-content">(無人參賽)</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">20</td><td data-label="預計時間" class="table-cell-content text-center-column">13:40 - 13:55</td><td data-label="項目" class="table-cell-content text-center-column">男子 400公尺自由式</td><td data-label="參賽隊員" class="table-cell-content">仲曛、梓宏</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">21</td><td data-label="預計時間" class="table-cell-content text-center-column">13:55 - 14:10</td><td data-label="項目" class="table-cell-content text-center-column">女子 100公尺蝶式</td><td data-label="參賽隊員" class="table-cell-content">(無人參賽)</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">22</td><td data-label="預計時間" class="table-cell-content text-center-column">14:10 - 14:20</td><td data-label="項目" class="table-cell-content text-center-column">男子 100公尺蝶式</td><td data-label="參賽隊員" class="table-cell-content">(無人參賽)</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">23</td><td data-label="預計時間" class="table-cell-content text-center-column">14:20 - 14:30</td><td data-label="項目" class="table-cell-content text-center-column">女子 200公尺蛙式</td><td data-label="參賽隊員" class="table-cell-content">(無人參賽)</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">24</td><td data-label="預計時間" class="table-cell-content text-center-column">14:30 - 14:45</td><td data-label="項目" class="table-cell-content text-center-column">男子 200公尺蛙式</td><td data-label="參賽隊員" class="table-cell-content">品謙、柏淵</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">25</td><td data-label="預計時間" class="table-cell-content text-center-column">14:45 - 15:05</td><td data-label="項目" class="table-cell-content text-center-column">男女 400公尺混合式接力</td><td data-label="參賽隊員" class="table-cell-content">TBD</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">26</td><td data-label="預計時間" class="table-cell-content text-center-column">15:05 - 15:20</td><td data-label="項目" class="table-cell-content text-center-column">女子 50公尺仰式</td><td data-label="參賽隊員" class="table-cell-content">又綺、宥妏、敏蓁、嘉妤</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">27</td><td data-label="預計時間" class="table-cell-content text-center-column">15:20 - 15:35</td><td data-label="項目" class="table-cell-content text-center-column">男子 50公尺仰式</td><td data-label="參賽隊員" class="table-cell-content">澤享、至瀚、浩元、岱融</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">28</td><td data-label="預計時間" class="table-cell-content text-center-column">15:35 - 15:45</td><td data-label="項目" class="table-cell-content text-center-column">女子 50公尺自由式</td><td data-label="參賽隊員" class="table-cell-content">禹榛、毛毛、敏蓁、亮柔*</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">29</td><td data-label="預計時間" class="table-cell-content text-center-column">15:45 - 15:55</td><td data-label="項目" class="table-cell-content text-center-column">男子 50公尺自由式</td><td data-label="參賽隊員" class="table-cell-content">則文、大益、Felix、康驊、為政、晟剛、宸瑋*</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">30</td><td data-label="預計時間" class="table-cell-content text-center-column">15:55 - 16:05</td><td data-label="項目" class="table-cell-content text-center-column">女子 50公尺蛙式</td><td data-label="參賽隊員" class="table-cell-content">小宜臻</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">31</td><td data-label="預計時間" class="table-cell-content text-center-column">16:05 - 16:20</td><td data-label="項目" class="table-cell-content text-center-column">男子 50公尺蛙式</td><td data-label="參賽隊員" class="table-cell-content">則睿、Felix、浩元、岱融</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">32</td><td data-label="預計時間" class="table-cell-content text-center-column">16:20 - 16:35</td><td data-label="項目" class="table-cell-content text-center-column">女子 200公尺仰式</td><td data-label="參賽隊員" class="table-cell-content">(無人參賽)</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">33</td><td data-label="預計時間" class="table-cell-content text-center-column">16:35 - 16:50</td><td data-label="項目" class="table-cell-content text-center-column">男子 200公尺仰式</td><td data-label="參賽隊員" class="table-cell-content">(無人參賽)</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">34</td><td data-label="預計時間" class="table-cell-content text-center-column">16:50 - 17:05</td><td data-label="項目" class="table-cell-content text-center-column">女子 400公尺自由式接力</td><td data-label="參賽隊員" class="table-cell-content">TBD</td></tr>
                        <tr class="schedule-row"><td data-label="編號" class="table-cell-content text-center-column">35</td><td data-label="預計時間" class="table-cell-content text-center-column">17:05 - 17:20</td><td data-label="項目" class="table-cell-content text-center-column">男子 400公尺自由式接力</td><td data-label="參賽隊員" class="table-cell-content">TBD</td></tr>
                        <tr class="schedule-row bg-gray-50"><td data-label="編號" class="table-cell-content text-center-column">36</td><td data-label="預計時間" class="table-cell-content text-center-column">17:20 - 17:35</td><td data-label="項目" class="table-cell-content text-center-column">大隊接力</td><td data-label="參賽隊員" class="table-cell-content">TBD</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- 結語 -->
        <footer class="mt-10 pt-4 border-t border-gray-300 text-center">
            <p class="text-xl font-bold text-ncp-blue">
                松竹梅是我們展現團結與實力的時刻，大家週六見，加油！💪
            </p>
        </footer>

    </div>

    <script>
        // 隊員列表 (用於下拉選單)
        const memberList = [
            "柏巧", "康驊", "仲曛", "梓宏", "慶瑜*", "秉陞", "Emma", "小宜臻", "品謙", "則睿", 
            "柏淵", "嘉穎", "宥妏", "又綺", "禹榛", "乃予", "澤享", "則文", "至瀚", "大益", 
            "晟剛", "宸瑋*", "毛毛", "亮柔*", "為政", "Felix", "岱融", "浩元", "敏蓁"
        ].sort();
        
        // 完整的比賽細節數據 (項次、項目、分組、水道、姓名)
        const competitionDetails = [
            // 項次, 項目, 分組, 水道, 姓名 (使用化名)
            {項次: '1', 項目: '女子組200公尺自由式', 分組: '2之1', 水道: '3', 姓名: '柏巧'},
            {項次: '2', 項目: '男子組200公尺自由式', 分組: '3之2', 水道: '3', 姓名: '梓宏'},
            {項次: '2', 項目: '男子組200公尺自由式', 分組: '3之3', 水道: '2', 姓名: '康驊'},
            {項次: '2', 項目: '男子組200公尺自由式', 分組: '3之3', 水道: '3', 姓名: '仲曛'},
            {項次: '2', 項目: '男子組200公尺自由式', 分組: '3之3', 水道: '5', 姓名: '慶瑜*'},
            {項次: '4', 項目: '男子組200公尺蝶式', 分組: '1之1', 水道: '3', 姓名: '秉陞'},
            {項次: '5', 項目: '女子組100公尺蛙式', 分組: '3之1', 水道: '6', 姓名: 'Emma'},
            {項次: '5', 項目: '女子組100公尺蛙式', 分組: '3之3', 水道: '5', 姓名: '小宜臻'},
            {項次: '6', 項目: '男子組100公尺蛙式', 分組: '4之1', 水道: '7', 姓名: '柏淵'},
            {項次: '6', 項目: '男子組100公尺蛙式', 分組: '4之3', 水道: '7', 姓名: '則睿'},
            {項次: '6', 項目: '男子組100公尺蛙式', 分組: '4之4', 水道: '7', 姓名: '品謙'},
            {項次: '7', 項目: '女子組100公尺仰式', 分組: '2之2', 水道: '4', 姓名: '宥妏'},
            {項次: '7', 項目: '女子組100公尺仰式', 分組: '2之2', 水道: '7', 姓名: '嘉穎'},
            {項次: '9', 項目: '男女4x100尺自由式接力', 分組: '2之1', 水道: '3', 姓名: '全體隊員'},
            {項次: '10', 項目: '男子組4x100公尺自由式接力', 分組: '2之1', 水道: '3', 姓名: '全體隊員'}, // 修正接力名稱
            {項次: '11', 項目: '女子組50公尺蝶式', 分組: '5之2', 水道: '3', 姓名: '乃予'},
            {項次: '11', 項目: '女子組50公尺蝶式', 分組: '5之3', 水道: '2', 姓名: '又綺'},
            {項次: '11',項目: '女子組50公尺蝶式', 分組: '5之3', 水道: '3', 姓名: '嘉穎'},
            {項次: '11', 項目: '女子組50公尺蝶式', 分組: '5之3', 水道: '5', 姓名: '禹榛'},
            {項次: '12', 項目: '男子組50公尺蝶式', 分組: '8之3', 水道: '1', 姓名: '至瀚'},
            {項次: '12', 項目: '男子組50公尺蝶式', 分組: '8之3', 水道: '2', 姓名: '則文'},
            {項次: '12', 項目: '男子組50公尺蝶式', 分組: '8之6', 水道: '3', 姓名: '澤享'},
            {項次: '12', 項目: '男子組50公尺蝶式', 分組: '8之7', 水道: '2', 姓名: '大益'},
            {項次: '12', 項目: '男子組50公尺蝶式', 分組: '8之7', 水道: '4', 姓名: '宸瑋*'},
            {項次: '12', 項目: '男子組50公尺蝶式', 分組: '8之7', 水道: '7', 姓名: '晟剛'},
            {項次: '13', 項目: '女子組200公尺混合式', 分組: '2之2', 水道: '2', 姓名: 'Emma'},
            {項次: '13', 項目: '女子組200公尺混合式', 分組: '2之2', 水道: '5', 姓名: '毛毛'},
            {項次: '15', 項目: '女子組100公尺自由式', 分組: '4之3', 水道: '8', 姓名: '柏巧'},
            {項次: '15', 項目: '女子組100公尺自由式', 分組: '4之4', 水道: '6', 姓名: '亮柔*'},
            {項次: '16', 項目: '男子組100公尺自由式', 分組: '7之3', 水道: '6', 姓名: '秉陞'},
            {項次: '16', 項目: '男子組100公尺自由式', 分組: '7之5', 水道: '3', 姓名: '為政'},
            {項次: '17', 項目: '女子組4x100公尺混合式接力', 分組: '2之1', 水道: '4', 姓名: '全體隊員'},
            {項次: '18', 項目: '男子組4x100公尺混合式接力', 分組: '2之1', 水道: '3', 姓名: '全體隊員'},
            
            // 下午場
            {項次: '20', 項目: '男子組400公尺自由式', 分組: '2之1', 水道: '2', 姓名: '仲曛'},
            {項次: '20', 項目: '男子組400公尺自由式', 分組: '2之1', 水道: '4', 姓名: '梓宏'},
            {項次: '24', 項目: '男子組200公尺蛙式', 分組: '2之2', 水道: '1', 姓名: '品謙'},
            {項次: '24', 項目: '男子組200公尺蛙式', 分組: '2之2', 水道: '7', 姓名: '柏淵'},
            {項次: '25', 項目: '男女組4x100公尺混合式接力', 分組: '2之1', 水道: '3', 姓名: '全體隊員'},
            {項次: '26', 項目: '女子組50公尺仰式', 分組: '4之2', 水道: '6', 姓名: '宥妏'},
            {項次: '26', 項目: '女子組50公尺仰式', 分組: '4之3', 水道: '4', 姓名: '敏蓁'},
            {項次: '26', 項目: '女子組50公尺仰式', 分組: '4之4', 水道: '7', 姓名: '又綺'},
            {項次: '27', 項目: '男子組50公尺仰式', 分組: '4之1', 水道: '7', 姓名: '岱融'},
            {項次: '27', 項目: '男子組50公尺仰式', 分組: '4之2', 水道: '3', 姓名: '至瀚'},
            {項次: '27', 項目: '男子組50公尺仰式', 分組: '4之3', 水道: '4', 姓名: '澤享'},
            {項次: '27', 項目: '男子組50公尺仰式', 分組: '4之3', 水道: '7', 姓名: '浩元'},
            {項次: '28', 項目: '女子組50公尺自由式', 分組: '8之1', 水道: '6', 姓名: '敏蓁'},
            {項次: '28', 項目: '女子組50公尺自由式', 分組: '8之2', 水道: '4', 姓名: '毛毛'},
            {項次: '28', 項目: '女子組50公尺自由式', 分組: '8之2', 水道: '7', 姓名: '禹榛'},
            {項次: '28', 項目: '女子組50公尺自由式', 分組: '8之8', 水道: '2', 姓名: '亮柔*'},
            {項次: '29', 項目: '男子組50公尺自由式', 分組: '11之3', 水道: '3', 姓名: '晟剛'},
            {項次: '29', 項目: '男子組50公尺自由式', 分組: '11之7', 水道: '3', 姓名: '為政'},
            {項次: '29', 項目: '男子組50公尺自由式', 分組: '11之7', 水道: '6', 姓名: '則文'},
            {項次: '29', 項目: '男子組50公尺自由式', 分組: '11之8', 水道: '4', 姓名: 'Felix'},
            {項次: '29', 項目: '男子組50公尺自由式', 分組: '11之8', 水道: '5', 姓名: '康驊'},
            {項次: '29', 項目: '男子組50公尺自由式', 分組: '11之10', 水道: '3', 姓名: '大益'},
            {項次: '29', 項目: '男子組50公尺自由式', 分組: '11之11', 水道: '2', 姓名: '宸瑋*'},
            {項次: '30', 項目: '女子組50公尺蛙式', 分組: '5之5', 水道: '2', 姓名: '小宜臻'},
            {項次: '31', 項目: '男子組50公尺蛙式', 分組: '7之2', 水道: '3', 姓名: '岱融'},
            {項次: '31', 項目: '男子組50公尺蛙式', 分組: '7之5', 水道: '2', 姓名: '則睿'},
            {項次: '31', 項目: '男子組50公尺蛙式', 分組: '7之5', 水道: '5', 姓名: 'Felix'},
            {項次: '31', 項目: '男子組50公尺蛙式', 分組: '7之6', 水道: '2', 姓名: '浩元'},
            {項次: '34', 項目: '女子組4x100公尺自由式接力', 分組: '2之1', 水道: '3', 姓名: '全體隊員'},
            {項次: '35', 項目: '男子組4x100公尺自由式接力', 分組: '2之1', 水道: '3', 姓名: '全體隊員'},
            {項次: '36', 項目: '大隊接力', 分組: '2之1', 水道: '3', 姓名: '全體隊員'}
        ];

        const ROW_CLASS = 'schedule-row';
        const HIGHLIGHT_CLASS = 'highlighted-row';
        const ALT_BG_CLASS = 'bg-gray-50';

        function populateMemberSelector() {
            const selector = document.getElementById('member-selector');
            memberList.forEach(member => {
                const option = document.createElement('option');
                option.value = member;
                option.textContent = member;
                selector.appendChild(option);
            });
        }

        /**
         * Converts a time string (HH:MM) to minutes past midnight.
         */
        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }

        /**
         * Converts minutes past midnight back to a time string (HH:MM).
         */
        function minutesToTime(totalMinutes) {
            const hours = String(Math.floor(totalMinutes / 60)).padStart(2, '0');
            const minutes = String(totalMinutes % 60).padStart(2, '0');
            return `${hours}:${minutes}`;
        }
        
        /**
         * Calculates the check-in time (15 minutes before the start time).
         */
        function calculateCheckInTime(startTime) {
            const startMinutes = timeToMinutes(startTime);
            const checkInMinutes = startMinutes - 15;
            return minutesToTime(checkInMinutes);
        }

        /**
         * Finds the first competition start time for a given event ID.
         */
        function getEventStartTime(eventId) {
            const tableAm = document.getElementById('schedule-table-am');
            const tablePm = document.getElementById('schedule-table-pm');

            const findTime = (table) => {
                const rows = table.querySelectorAll('tbody tr');
                for (const row of rows) {
                    const idCell = row.querySelector('[data-label="編號"]');
                    const timeCell = row.querySelector('[data-label="預計時間"]');
                    if (idCell && timeCell && idCell.textContent.trim() === eventId) {
                        const timeRange = timeCell.textContent.trim();
                        // Time range format is 'HH:MM - HH:MM'
                        return timeRange.split(' - ')[0].trim();
                    }
                }
                return null;
            };

            return findTime(tableAm) || findTime(tablePm);
        }

        /**
         * Gets the full time range for a given event ID from the main schedule table.
         */
        function getEventTimeRange(eventId) {
             const tableAm = document.getElementById('schedule-table-am');
             const tablePm = document.getElementById('schedule-table-pm');

             const findTimeRange = (table) => {
                const rows = table.querySelectorAll('tbody tr');
                for (const row of rows) {
                    const idCell = row.querySelector('[data-label="編號"]');
                    const timeCell = row.querySelector('[data-label="預計時間"]');
                    if (idCell && timeCell && idCell.textContent.trim() === eventId) {
                        return timeCell.textContent.trim();
                    }
                }
                return null;
            };
            
            return findTimeRange(tableAm) || findTimeRange(tablePm) || 'N/A';
        }

        function highlightMember(selectedName) {
            const rows = document.querySelectorAll(`.${ROW_CLASS}`);
            const scheduleSection = document.getElementById('schedule-section');
            const summaryCard = document.getElementById('summary-card');
            
            let eventsFound = [];
            
            // 1. 清除所有高亮、恢復交替背景
            rows.forEach((row, index) => {
                row.classList.remove(HIGHLIGHT_CLASS);
                row.classList.remove(ALT_BG_CLASS); 
                
                // 恢復交替背景色
                if (row.closest('table').id === 'schedule-table-am') {
                     // 上午場
                     if (index % 2 !== 0) {
                        row.classList.add(ALT_BG_CLASS);
                    }
                } else {
                    // 下午場
                    const offsetIndex = index;
                     if (offsetIndex % 2 !== 0) {
                        row.classList.add(ALT_BG_CLASS);
                    }
                }
            });
            summaryCard.classList.add('hidden');


            if (!selectedName) {
                return; // 未選擇隊員則退出
            }

            // 2. 應用新高亮並收集資料
            // 移除名字末尾的 '*' 以匹配 competitionDetails 中的非 * 名字
            const safeName = selectedName.endsWith('*') ? selectedName.slice(0, -1) : selectedName; 
            
            // 正則表達式匹配: 名字在頓號分隔的列表中 (e.g., ^嘉穎$ or ^嘉穎, or ,嘉穎$ or ,嘉穎,)
            // 由於名字已經是化名，直接匹配更安全。
            const escapedName = selectedName.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp(`(^|、)${escapedName}(\\s*($|、))`);

            rows.forEach((row) => {
                const memberCell = row.querySelector('[data-label="參賽隊員"]');
                
                if (memberCell && regex.test(memberCell.textContent.trim())) {
                    // 移除交替背景並套用高亮
                    row.classList.remove(ALT_BG_CLASS);
                    row.classList.add(HIGHLIGHT_CLASS);
                }
            });
            
            // 3. 根據選中的名字從 competitionDetails 提取完整的比賽細節
            // 使用原始 selectedName 進行精確匹配，包括 *
            competitionDetails
                .filter(detail => detail.姓名 === selectedName)
                .forEach(detail => {
                    const startTimeStr = getEventStartTime(detail.項次);
                    const checkInTime = startTimeStr ? calculateCheckInTime(startTimeStr) : 'N/A';

                    eventsFound.push({
                        項次: detail.項次,
                        項目: detail.項目,
                        分組: detail.分組,
                        水道: detail.水道,
                        checkIn: checkInTime,
                        timeRange: getEventTimeRange(detail.項次) 
                    });
                });


            // 4. 填充並顯示卡片
            if (eventsFound.length > 0) {
                let summaryHtml = '<h3 class="text-xl font-bold text-ncp-dark mb-3">🏅 ' + selectedName + ' 的參賽項目</h3>';
                
                // 專屬賽程卡片使用表格佈局
                summaryHtml += `
                    <div class="overflow-x-auto shadow-md rounded-lg border border-gray-300">
                    <table class="min-w-full text-sm bg-white">
                        <thead>
                            <tr class="bg-ncp-blue text-white">
                                <th class="py-2 px-3">項次</th>
                                <th class="py-2 px-3">項目</th>
                                <th class="py-2 px-3 text-center">分組</th>
                                <th class="py-2 px-3 text-center">水道</th>
                                <th class="py-2 px-3 text-center">預計檢錄時間</th>
                                <th class="py-2 px-3 text-center">預計比賽時間</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                eventsFound.forEach((event, index) => {
                    summaryHtml += `
                        <tr class="${index % 2 === 0 ? 'bg-gray-50' : 'bg-white'} border-b">
                            <td class="py-2 px-3 font-semibold">${event.項次}</td>
                            <td class="py-2 px-3">${event.項目}</td>
                            <td class="py-2 px-3 text-center">${event.分組}</td>
                            <td class="py-2 px-3 text-center">${event.水道}</td>
                            <td class="py-2 px-3 text-center font-bold text-red-600">${event.checkIn}</td>
                            <td class="py-2 px-3 text-center">${event.timeRange}</td>
                        </tr>
                    `;
                });
                
                summaryHtml += `
                        </tbody>
                    </table>
                    </div>
                `;
                
                summaryCard.innerHTML = summaryHtml;
                summaryCard.classList.remove('hidden');
                
                // 5. 自動捲動到賽程表區塊 (包含卡片)
                if (scheduleSection) {
                    scheduleSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            }
        }
        
        document.addEventListener('DOMContentLoaded', populateMemberSelector);
    </script>

</body>
</html>


